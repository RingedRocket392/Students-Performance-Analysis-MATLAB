function [h, p, stats] = chi2cont(tbl)
    % Custom Chi-Square test for a contingency table

    rowSum = sum(tbl, 2);
    colSum = sum(tbl, 1);
    total = sum(tbl(:));
    expected = (rowSum * colSum) / total;

    chi2 = sum((tbl - expected).^2 ./ expected, 'all');
    df = (size(tbl,1) - 1) * (size(tbl,2) - 1);
    p = 1 - chi2cdf(chi2, df);

    h = p < 0.05;
    stats.chi2stat = chi2;
    stats.df = df;
    stats.expected = expected;
end
